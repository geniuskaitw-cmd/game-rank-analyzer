name: æ¸¬è©¦è³‡æ–™æŠ“å–èˆ‡å„²å­˜
on:
  workflow_dispatch:
    # åƒ…å…è¨±æ‰‹å‹•å¾ Actions åˆ†é åŸ·è¡Œæ­¤å·¥ä½œæµ

jobs:
  run_fetch_test:
    runs-on: ubuntu-latest

    # === æ–°å¢ï¼šè³¦äºˆå·¥ä½œ "å¯«å…¥" æ¬Šé™ ===
    permissions:
      contents: write
    # ==================================

    steps:
      - name: 1. Checkout repository code
        uses: actions/checkout@v4
        with:
          persist-credentials: false
          fetch-depth: 0 
          
      - name: 2. Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.x'

      - name: 3. Install dependencies
        run: |
          # åƒ…å®‰è£ fetch_ios_rss.py éœ€è¦çš„å‡½å¼åº«
          pip install requests
          
      # === åƒ…åŸ·è¡Œæ­¥é©Ÿ 2 (æŠ“å–åŸå§‹æ¦œå–®) ===
      - name: 4. Run fetch_ios_rss.py (Fetch Ranks)
        run: python scripts/fetch_ios_rss.py
        
      # === æäº¤è®Šå‹• (å°‡ JSON æ•¸æ“šæ¨å›å„²å­˜åº«) ===
      # é€™æ˜¯æˆ‘å€‘è¦æ¸¬è©¦çš„é—œéµï¼šç¢ºèª .gitignore ä¿®æ­£å¾Œï¼Œæª”æ¡ˆæœƒè¢«æäº¤
      - name: 5. Commit and Push generated data
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          # æäº¤ data è³‡æ–™å¤¾ä¸­çš„æ‰€æœ‰å…§å®¹
          file_pattern: data/*
          commit_message: "ğŸ¤– Test: Auto-generated raw rank data"
          commit_user_name: GitHub Actions Bot
          commit_user_email: actions@github.com

